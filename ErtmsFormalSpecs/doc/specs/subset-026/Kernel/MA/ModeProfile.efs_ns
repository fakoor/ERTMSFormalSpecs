<NameSpace
 X="20"
 Y="70"
 Width="100"
 Height="50"
 Name="ModeProfile"
 Guid="cb25e4ae-499f-476f-8599-0113103669f1"
>
<NameSpaces>
</NameSpaces>
<Structures>
<Structure
 Default=""
 X="390"
 Y="310"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="ModeProfileStruct"
 Guid="75913f7d-934d-437f-be60-0a28d46d8587"
>
<ReqRef
 Id="b4a804d0-53f6-49e2-9897-24b3babe34bd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="71f84709-ef29-467d-bba4-410f650a9f0d"
>
</ReqRef><Comment>Represents a mode profile.</Comment>
<StructureElement
 TypeName="BaseTypes.Distance"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="Location"
 Guid="0cc7a6c9-2aae-483f-bd2a-e9a3e55ea2be"
>
<ReqRef
 Id="89925322-dec9-4aa4-8555-37decb3284a8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5f9a4bf6-edae-49cb-80e3-5663151b52b5"
>
</ReqRef><ReqRef
 Id="41d92e15-57e4-42b2-b756-c81a36b02db7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="47607aa1-686d-4620-b315-955c29c1aee3"
>
</ReqRef><ReqRef
 Id="b5036802-ea03-4dbd-bf0e-3bbb99b7059e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bc352759-7f8a-49fc-9f7f-0b8e62c25a97"
>
</ReqRef></StructureElement><StructureElement
 TypeName="ModeEnum.ModeProfile"
 Default="ModeEnum.ModeProfile.LS"
 Mode="Internal"
 Implemented="TRUE"
 Name="Mode"
 Guid="14abea86-58fb-4797-acb1-c23ea3d66b6b"
>
<ReqRef
 Id="8f6cbd01-6f4a-4a45-9b12-053cfa6bbf95"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ccce08ec-2fef-49c7-9fb0-d52b0756649a"
>
</ReqRef></StructureElement><StructureElement
 TypeName="BaseTypes.Speed"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="Speed"
 Guid="1cbafab9-7a7a-4a77-a0a6-cf4e19a7e1c2"
>
<ReqRef
 Id="64e2f87a-5cf2-41b5-880c-dd026169eb44"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="85c542ce-4562-4198-9944-84b7baedd20b"
>
</ReqRef></StructureElement><StructureElement
 TypeName="BaseTypes.Length"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="Length"
 Guid="087c3054-e554-497e-882a-dec41811550b"
>
<ReqRef
 Id="d4f0c125-9a62-4674-b0f5-bcba928f4835"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bedd835e-b271-412b-8672-72de428e3996"
>
</ReqRef></StructureElement><StructureElement
 TypeName="BaseTypes.Length"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="AcknLength"
 Guid="acc4b025-cd7e-4126-a90c-742b57c57d27"
>
<ReqRef
 Id="e91cb267-376b-429f-8918-4d597fdcc562"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="92bf8fc4-f46d-4659-b52b-b1f466514a55"
>
</ReqRef></StructureElement><StructureElement
 TypeName="Messages.Q_MAMODE"
 Default="Messages.Q_MAMODE.as_both_the_EOA_and_SvL__instead_of_the_EOA_and_SvL_given_by_the_MA"
 Mode="Internal"
 Implemented="TRUE"
 Name="SupervisionQualifier"
 Guid="202c1cd1-8f68-4f01-a829-6c6c50903df5"
>
<ReqRef
 Id="1eede305-f64b-4f63-a204-1c83dcb1ed2f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="77353074-200c-4e38-b3c7-2e2f47bf4e8d"
>
</ReqRef></StructureElement><Interfaces>
<StructureRef
 Name="BaseTypes.LocationLengthInterface"
 Guid="95d9b23c-7d10-4c96-b42a-7330e5d9a148"
>
</StructureRef></Interfaces>
</Structure></Structures>
<Collections>
<Collection
 TypeName="ModeProfileStruct"
 MaxSize="20"
 Default="[]"
 X="220"
 Y="310"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="ModeProfileCol"
 Guid="df0aa68f-39be-4030-b122-a8af9ee50ca1"
>
</Collection></Collections>
<Functions>
<Function
 Type="Boolean"
 Default=""
 X="40"
 Y="20"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="DistanceIsWithinAModeProfile"
 Guid="39b55868-566d-4ddf-abe5-fc45af1b275c"
>
<ReqRef
 Id="d36ad0a3-d955-4bcf-8e7c-29e8ad53a491"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b8b7ce67-6bd5-41bc-8e90-a47931822b07"
>
</ReqRef><ReqRef
 Id="522c85b9-86d1-4001-8889-a1a4e5ca7c51"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d97eb0cd-7688-4fff-96ed-8f8a8cb9f1e9"
>
</ReqRef><ReqRef
 Id="3b16e285-2513-4123-a986-2b50cf27f60f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ec0d7f3d-c481-4517-b8a7-d58fb298739e"
>
</ReqRef><ReqRef
 Id="c3a0339b-08aa-4713-aace-4e545d160b65"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1af53e38-b9d7-49c5-8fb3-49572c682125"
>
</ReqRef><ReqRef
 Id="b4a804d0-53f6-49e2-9897-24b3babe34bd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2b0c8f74-019e-4c69-92c1-ef94b273eab0"
>
</ReqRef><ReqRef
 Id="25c1b633-d7e9-42a2-be80-037ff105dcd8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ff741fe8-5947-4f90-93d9-8da61ff544c2"
>
</ReqRef><ReqRef
 Id="68290e3a-68aa-485c-9b80-ad0a6da08d3f"
 SpecId="c238ead1-8ba7-4613-ae49-4288833ea80d"
 Guid="236698e9-6865-4a74-a60a-d048338617ae"
>
</ReqRef><ReqRef
 Id="dbd12b73-87dc-4f8b-aad5-7e3cb90fa5b1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="455d0908-c75c-4055-945d-7ffc5337ccf0"
>
</ReqRef><Comment>This function indicates whether a mode profile as requested by the trackside is applicable according to the train position and mode</Comment>
<Parameters>
<Parameter
 Type="ModeProfileStruct"
 Name="aModeProfile"
 Guid="5f79a1a2-7e43-4b47-93b8-5f4067577550"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="SH"
 Guid="8948b082-6c1f-4fa8-bfd3-b95622c286b3"
>
<PreConditions>
<PreCondition
 Guid="6114dc4d-7678-4510-95a8-2144c9f43f82"
>aModeProfile.Mode == ModeEnum.ModeProfile.SH</PreCondition></PreConditions>
<Expression>aModeProfile.Location &lt;= Kernel.TrainPosition.FrontEndPosition ( DistanceIntervalEnum.Max )</Expression>
</Case><Case
 Name="OS"
 Guid="1f7deadc-8146-439c-97b2-3edcf63db2a9"
>
<PreConditions>
<PreCondition
 Guid="46a20481-6c6f-4178-9b7a-b6bfe09b0264"
>aModeProfile.Mode == ModeEnum.ModeProfile.OS</PreCondition></PreConditions>
<Expression>aModeProfile.Location &lt;= Kernel.TrainPosition.FrontEndPosition ( DistanceIntervalEnum.Max )
  AND
Kernel.TrainPosition.FrontEndPosition ( DistanceIntervalEnum.Min ) &lt; aModeProfile.Location + BaseTypes.LengthToDistance ( aModeProfile.Length )
  AND
Kernel.Level.Value.Value in [LevelEnum.L1, LevelEnum.L2, LevelEnum.L3]</Expression>
</Case><Case
 Name="LS"
 Guid="8c23abbf-e779-492b-8354-f7f9276a904a"
>
<Expression>aModeProfile.Location &lt;= Kernel.TrainPosition.FrontEndPosition ( DistanceIntervalEnum.Max )
  AND
Kernel.TrainPosition.FrontEndPosition ( DistanceIntervalEnum.Min ) &lt; aModeProfile.Location + BaseTypes.LengthToDistance ( aModeProfile.Length )</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="150"
 Y="20"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="ModeProfileIsApplicable"
 Guid="3f481255-8672-487c-8369-61d528f68163"
>
<ReqRef
 Id="d7eddae1-a7bf-4be3-8180-19f2e70ac2fd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="39dc7a5b-e779-417c-856c-4c64e105ebe7"
>
</ReqRef><ReqRef
 Id="84c5d520-4f6e-4239-99e9-92522d5ed604"
 SpecId="c238ead1-8ba7-4613-ae49-4288833ea80d"
 Guid="71060e6a-7ec2-4198-bd87-d927bde4f74a"
>
</ReqRef><Comment>Indicates if the mode profile is applicable (i.e. there is a mode profile stored on-board and the train is within this mode profile).</Comment>
<Cases>
<Case
 Name="Mode profile not available"
 Guid="4b4310b8-065b-46d8-94ef-ecc033e5531a"
>
<PreConditions>
<PreCondition
 Guid="3b0b7828-cb17-4b0f-b2d7-98074e563129"
>Kernel.MA.MA == EMPTY OR Kernel.MA.ModeProfile.Profile == []</PreCondition></PreConditions>
<Expression>False</Expression>
</Case><Case
 Name="Mode profile available"
 Guid="b3d11290-015c-4b99-9601-fe80c8d7ebc7"
>
<Expression>LET modeProfile &lt;- FIRST X IN Kernel.MA.ModeProfile.Profile IN

Kernel.MA.ModeProfile.DistanceIsWithinAModeProfile ( modeProfile )

  OR  
(
  Kernel.Mode == modeProfile.Mode
    AND  
  AcknAreaReached( modeProfile)
)</Expression>
</Case></Cases>
</Function><Function
 Type="ModeEnum.ModeProfile"
 Default=""
 X="40"
 Y="80"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="CurrentMode"
 Guid="ba4c9d24-cadc-4470-b658-69c1bdc024f9"
>
<ReqRef
 Id="66ed413a-6b6e-4b23-b847-4b1870c4d831"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="62272c20-587d-4cf8-af77-0c80e0364bc5"
>
</ReqRef><Comment>Provides the first mode of the mode profile.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="951cc127-221a-4c9f-8e74-8a45b13fdf27"
>
<Expression>( FIRST X IN Kernel.MA.ModeProfile.Profile ).Mode</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="150"
 Y="140"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="RemoveModeProfile"
 Guid="0b4e5f8b-0a62-4620-834a-8154496cc8ac"
>
<ReqRef
 Id="03b6c53e-3c15-4db3-8d90-3353c60fd14d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f14a9271-5483-49fb-af8f-7caa6117f643"
>
</ReqRef><ReqRef
 Id="eaa70a17-109a-45b5-8747-ecc49e581ccd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7a26f171-5b10-4050-8d75-a9f63001275d"
>
</ReqRef><Comment>Indicates if the current mode profile has to be removed.</Comment>
<Parameters>
<Parameter
 Type="ModeProfileStruct"
 Name="aProfile"
 Guid="30f1c5a6-0d93-409e-aef7-b8968e2caab2"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="OS or LS"
 Guid="d88b3f0d-3c6b-4070-9b50-140262edde84"
>
<PreConditions>
<PreCondition
 Guid="287768f9-ea4e-48fe-a272-30d38aff9d61"
>aProfile.Mode == ModeEnum.ModeProfile.OS
  OR  
aProfile.Mode == ModeEnum.ModeProfile.LS</PreCondition></PreConditions>
<Expression>Kernel.TrainPosition.FrontEndPosition ( DistanceIntervalEnum.Min ) &gt;= aProfile.Location + BaseTypes.LengthToDistance ( aProfile.Length )</Expression>
</Case><Case
 Name="SH"
 Guid="df9e81c4-d70f-4918-b476-41109e9e77a5"
>
<Expression>False</Expression>
</Case></Cases>
</Function><Function
 Type="ModeProfileStruct"
 Default=""
 X="40"
 Y="200"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="KeepTheProfileAccordingToLocation"
 Guid="00b092f7-ea4d-4143-b544-b7d57cb8871b"
>
<ReqRef
 Id="2a495f6e-680c-4def-a6b5-d8bcd1f41a9d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6b4a5586-cd43-444e-a590-2a9f7b29caa2"
>
</ReqRef><Comment>Indicates for the given mode profile element if it will be kept or not according to the given location. There are three possible cases:
1. If the mode profile element is before the given location, it should be kept (the whole mode profile element is returned).
2. If the mode profile element is after the given location, it will be deleted (EMPTY is returned).
3. If the given location is inside the mode profile element, the latter is shortened until the given location.</Comment>
<Parameters>
<Parameter
 Type="ModeProfileStruct"
 Name="aProfile"
 Guid="5edee4a2-0bce-4cdb-b56b-560b902fb90a"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="aLocation"
 Guid="93793903-c8a7-4a12-a92c-12c9a0ed3fe5"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Infill location before profile"
 Guid="3f7cac04-843d-46e7-b1bd-ac87e75d8571"
>
<PreConditions>
<PreCondition
 Guid="24609d85-64ee-4f58-81e9-da0bd36e1703"
>aProfile.Location + BaseTypes.LengthToDistance ( aProfile.Length ) &lt;= aLocation</PreCondition></PreConditions>
<Expression>aProfile</Expression>
</Case><Case
 Name="Infill location inside profile"
 Guid="64c1a003-f722-4380-8ac3-35d56678e659"
>
<Expression>Kernel.MA.ModeProfile.ModeProfileStruct
{
    AcknLength =&gt; aProfile.AcknLength,
    Location =&gt; aProfile.Location,
    Length =&gt; BaseTypes.DistanceToLength(aLocation - aProfile.Location),
    Mode =&gt; aProfile.Mode,
    Speed =&gt; aProfile.Speed,
    SupervisionQualifier =&gt; aProfile.SupervisionQualifier
}</Expression>
</Case></Cases>
</Function><Function
 Type="ModeEnum.ModeProfile"
 Default=""
 X="150"
 Y="80"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="ERTMS_To_EFS_Mode"
 Guid="5fd9933c-08ff-435f-aece-f31cc161c2de"
>
<Comment>Converts the modes received from the trackside to the modes used by EFS.</Comment>
<Parameters>
<Parameter
 Type="Messages.M_MAMODE"
 Name="aMode"
 Guid="4d181f77-f762-4f22-9f1d-b05df78c9132"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="OS"
 Guid="95d38ffb-41bd-4917-8a04-0faf880f4607"
>
<PreConditions>
<PreCondition
 Guid="0ea7502a-e0f8-464b-a7cc-6313b6c6035f"
>aMode == Messages.M_MAMODE.On_Sight</PreCondition></PreConditions>
<Expression>ModeEnum.ModeProfile.OS</Expression>
</Case><Case
 Name="LS"
 Guid="a93f9055-cc83-435f-83ab-188b4de199bc"
>
<PreConditions>
<PreCondition
 Guid="7397d7ea-e622-4b41-b913-2ff9c0bd3b4b"
>aMode == Messages.M_MAMODE.Limited_Supervision</PreCondition></PreConditions>
<Expression>ModeEnum.ModeProfile.LS</Expression>
</Case><Case
 Name="SH"
 Guid="7e925daa-edf8-4339-82f1-d7c5cfd95737"
>
<PreConditions>
<PreCondition
 Guid="4a26be35-7bf2-44a7-8591-c3a946778451"
>aMode == Messages.M_MAMODE.Shunting</PreCondition></PreConditions>
<Expression>ModeEnum.ModeProfile.SH</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="260"
 Y="20"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="AcknAreaReached"
 Guid="101ad133-d946-48a4-86ff-efa58065c439"
>
<ReqRef
 Id="f8b146ed-492a-43af-b78d-fbd3e12aa731"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bac096af-4ce9-4938-82ea-6aabe029ef9d"
>
</ReqRef><ReqRef
 Id="69196e9c-9533-43f3-8c1f-cd9a9b248178"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7c50632b-e866-444d-89bd-c23b4213d440"
>
</ReqRef><ReqRef
 Id="2ae92ee4-8298-478f-94c4-806e389cc5cb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="207b1744-f96c-4fdc-ab2c-60a8b6f45fde"
>
</ReqRef><Comment>Indicates if the acknowledgement area is reached for a given mode profile.</Comment>
<Parameters>
<Parameter
 Type="ModeProfileStruct"
 Name="aProfile"
 Guid="3da9327d-dc53-4a47-89c8-678a6b8d12ed"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="cd6ddbc2-9759-49af-bd95-8f4a684555e3"
>
<Expression>aProfile.Location - BaseTypes.LengthToDistance ( aProfile.AcknLength ) &lt;= Kernel.TrainPosition.FrontEndPosition ( DistanceIntervalEnum.Nom )</Expression>
</Case></Cases>
</Function><Function
 Type="TargetStruct"
 Default=""
 X="260"
 Y="80"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="EOA"
 Guid="ebdab32d-5390-43f3-a32f-0cb87bef5bbf"
>
<ReqRef
 Id="81828a4c-73e2-440d-8353-e050603f323f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d7e5eddc-3cbe-4115-9136-a905addc6b0d"
>
</ReqRef><ReqRef
 Id="6b1f5744-6c85-45eb-a7de-1eba5bad0131"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="21f3f252-bb0e-4594-90d4-f2edfcb184bd"
>
</ReqRef><ReqRef
 Id="f2ddac1e-eea7-4f30-ade6-5ace543c21ae"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a543c236-bbd7-4441-aa3b-7fba736f19c3"
>
</ReqRef><ReqRef
 Id="78901f0f-a70f-415d-8d57-e5156f7206d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1074ab9e-49b3-4308-ab7e-354f51c63e69"
>
</ReqRef><Comment>Provides the EOA due to the mode profile, if any.</Comment>
<Cases>
<Case
 Name="Mode Profile EOA available"
 Guid="35bb6df3-77eb-44a1-a069-ac7715eb8c61"
>
<PreConditions>
<PreCondition
 Guid="9f665942-1c2b-4bca-9ed1-3bba5e995a0c"
>Available ( Kernel.MA.MA )</PreCondition><PreCondition
 Guid="c4990a7c-151a-406f-8a0f-1d730706b1e6"
>Kernel.MA.ModeProfile.Profile != []</PreCondition><PreCondition
 Guid="72d9cd73-06fc-4d5b-abaa-ec05e4cb3dc7"
>Kernel.MA.ModeProfile.FirstNonApplicableModeProfile() != EMPTY</PreCondition></PreConditions>
<Expression>TargetStruct
{
    Location =&gt; ( MA.ModeProfile.FirstNonApplicableModeProfile() ).Location,
    Length =&gt; ( MA.ModeProfile.FirstNonApplicableModeProfile() ).Length,
    Speed =&gt; 0.0,
    Type =&gt; TargetTypeEnum.EOA
}</Expression>
</Case><Case
 Name="No Mode Profile EOA available"
 Guid="1983d666-3c4d-4573-b41e-f5ac4dde4c24"
>
<Expression>EMPTY</Expression>
</Case></Cases>
</Function><Function
 Type="TargetStruct"
 Default=""
 X="260"
 Y="140"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="SvL"
 Guid="105e4f55-76a4-490a-8482-3637297e2256"
>
<ReqRef
 Id="81828a4c-73e2-440d-8353-e050603f323f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ad188b1a-5d58-4304-8285-e1460ce5f39b"
>
</ReqRef><ReqRef
 Id="6b1f5744-6c85-45eb-a7de-1eba5bad0131"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="204e63e6-a7d6-4ba4-843e-cc4e6eea652c"
>
</ReqRef><ReqRef
 Id="f2ddac1e-eea7-4f30-ade6-5ace543c21ae"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d015959e-6c8f-4db1-9287-5b2e166456e5"
>
</ReqRef><ReqRef
 Id="78901f0f-a70f-415d-8d57-e5156f7206d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4f8394ff-7860-4e93-9550-1d7d4524d17b"
>
</ReqRef><Comment>Provides the SvL due to the mode profile, if any.</Comment>
<Cases>
<Case
 Name="Mode Profile SvL available"
 Guid="5dbb9bfb-4674-49fd-9b83-a74ce04de1fb"
>
<PreConditions>
<PreCondition
 Guid="6360e380-3cc4-43da-8cdc-1b090db6045d"
>Kernel.MA.ModeProfile.FirstNonApplicableModeProfile() != EMPTY
  AND
( Kernel.MA.ModeProfile.FirstNonApplicableModeProfile() ).SupervisionQualifier == Messages.Q_MAMODE.as_both_the_EOA_and_SvL__instead_of_the_EOA_and_SvL_given_by_the_MA</PreCondition><PreCondition
 Guid="30aa3403-c8b3-4807-bd15-b549f015ae93"
>Kernel.MA.ModeProfile.Profile != []</PreCondition><PreCondition
 Guid="ae49b5bd-f40e-49bd-b5bd-ea562a6cde15"
>Available ( Kernel.MA.MA )</PreCondition></PreConditions>
<Expression>TargetStruct
{
    Length =&gt; ( MA.ModeProfile.FirstNonApplicableModeProfile() ).Length,
    Location =&gt; ( MA.ModeProfile.FirstNonApplicableModeProfile() ).Location,
    Speed =&gt; 0.0,
    Type =&gt; TargetTypeEnum.SvL
}</Expression>
</Case><Case
 Name="No Mode Profile SvL available"
 Guid="aff5d04b-6d78-4293-b8f9-7d0d42286e48"
>
<Expression>EMPTY</Expression>
</Case></Cases>
</Function><Function
 Type="ModeProfileStruct"
 Default=""
 X="40"
 Y="140"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="FirstNonApplicableModeProfile"
 Guid="547b6baa-ee4d-4b17-8252-0289749bf194"
>
<Comment>This function provides the mode transition profile, as ordered by the trackside which is not yet applied to the train</Comment>
<Cases>
<Case
 Name="Value"
 Guid="81ce4b17-e0fc-4fcf-b185-424a867a20b1"
>
<Expression>FIRST X IN Kernel.MA.ModeProfile.Profile | NOT Kernel.MA.ModeProfile.DistanceIsWithinAModeProfile ( X ) AND (X.Mode != Kernel.Mode)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Cacheable="TRUE"
 Default=""
 X="150"
 Y="200"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="GetSpeedResolution"
 Guid="5ae2e65d-dd28-4c75-84a9-fae6d4e17967"
>
<ReqRef
 Id="64e2f87a-5cf2-41b5-880c-dd026169eb44"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9ecdf5b1-37a6-4686-a0c7-e3b95c91e981"
>
</ReqRef><ReqRef
 Id="d2ddd6a4-4c33-45a5-a596-27232819b185"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="53ed1055-eef9-41c3-b274-d4c13255d425"
>
</ReqRef><Comment>Converts the speed received in a Mode Profile packet to EFS speed, accounting for the special value.</Comment>
<Parameters>
<Parameter
 Type="MessageTypes.Speed"
 Name="V_MAMODE"
 Guid="b0e5bacb-91e5-4022-ab6f-46a554c924cc"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Use national value"
 Guid="00749932-d5a6-4498-88c3-2c4715fdd3be"
>
<PreConditions>
<PreCondition
 Guid="a04008ce-5107-483b-87cc-1c1834d883a1"
>V_MAMODE == 127</PreCondition></PreConditions>
<Expression>BaseTypes.Speed.UseNV</Expression>
</Case><Case
 Name="Otherwise"
 Guid="28661417-d59f-4103-a432-5018b5349e6a"
>
<Expression>MessageTypes.SpeedResolution ( speed =&gt; V_MAMODE, resolution =&gt; 5.0 )</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Distance"
 Default=""
 X="551"
 Y="1"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="AbsoluteDistance"
 Guid="e6a3b957-641f-4730-9769-b1e2e8a77a8c"
>
<ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="38b25a5e-a6e7-44e4-a350-8683c91875cd"
>
</ReqRef><Comment>Provides the full distance to the received mode profile element.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.Collection1"
 Name="ModeProfiles"
 Guid="e52e0305-6b21-4747-a01f-5394d0c4ddac"
>
</Parameter><Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.SubStructure1"
 Name="aModeProfile"
 Guid="a714a00d-38b5-46c8-a3cd-6a10fe023768"
>
</Parameter><Parameter
 Type="Messages.Q_SCALE"
 Name="Scale"
 Guid="918aa76f-a1fa-4e4b-831d-b431c15a6c18"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="1a75475e-22d0-4046-98b5-8243295e7326"
>
<Expression>SUM
    ModeProfiles |
        Before ( ExpectedFirst =&gt; X, ExpectedSecond =&gt; aModeProfile, Collection =&gt; ModeProfiles ) OR ( X == aModeProfile )
USING X IN
    MessageTypes.QScaleDistance ( distance =&gt; X.D_MAMODE, scale =&gt; Scale )</Expression>
</Case></Cases>
</Function></Functions>
<Procedures>
<Procedure
 X="570"
 Y="80"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="ModeProfileReceived"
 Guid="beb2c296-a5e1-4033-a491-317f0531dd26"
>
<ReqRef
 Id="4a580e9d-fd64-4951-b7a4-51530d1469e7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f67fc4c1-e794-4df9-a90f-774f072c842b"
>
</ReqRef><ReqRef
 Id="e6b9b34b-5183-45ec-96a2-8eef4909b34c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="22aa3dca-996b-4319-8f09-592b9a3bba56"
>
</ReqRef><ReqRef
 Id="85399986-8b1a-4ee5-ba62-20eb7ca0a3b9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3cf46ce2-be5c-4575-b83a-0ca3ff590a76"
>
</ReqRef><ReqRef
 Id="6f370d19-a99b-404b-9718-80331a17d9d4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="80310539-d9d7-4787-bad6-4d1f5cd69f16"
>
</ReqRef><ReqRef
 Id="ffdc9150-a628-4750-a762-a41c20c3dd26"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c1820a25-3bfd-401f-a1e4-f2133eaf72fd"
>
</ReqRef><ReqRef
 Id="456d49d8-e372-4a93-b53b-700d92362a8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="229a9524-32cf-484b-ae68-f473c4b7c205"
>
</ReqRef><ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6d4add5c-bb0c-4065-b089-449730a5fc7f"
>
</ReqRef><ReqRef
 Id="3b4bfa4e-f425-4b5d-a82e-aaaf923dad11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="356f0eac-f117-49ed-8ec0-4de8a27905ad"
>
</ReqRef><ReqRef
 Id="c57326e0-6fe8-4373-825f-149a86761548"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="16ecae77-d636-420d-8238-41f74279f0d6"
>
</ReqRef><ReqRef
 Id="6c2271aa-b854-4ce6-ba1f-4892e06164b4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1a92437c-cbe6-4dcb-be6c-cf028cf9d81a"
>
</ReqRef><Comment>Handles the reception of the mode profile.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.Message"
 Name="Packet"
 Guid="75b62463-3fa9-4c19-b2ec-dfce61799a11"
>
</Parameter><Parameter
 Type="Boolean"
 Name="GenericLSMarker"
 Guid="35fc88c4-2b37-44da-a0d2-1ff900415967"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="aDistanceFromRef"
 Guid="798b3d9e-24be-4f30-81d1-326708b557d4"
>
</Parameter><Parameter
 Type="Boolean"
 Name="infillModeProfile"
 Guid="02ac3899-d455-46d3-a261-4dbba4ab3780"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 Name="Add first profile"
 Guid="e66d71f8-c387-4ceb-bd8c-7ccf4fbcb946"
>
<Comment>Adds the first element of the mode profile.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Add new profile"
 Guid="14aee0f3-9f0e-4f8b-906c-eb50d95486eb"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="e3906603-1756-4c2c-bf27-60382dd7b1d2"
>Kernel.MA.ModeProfile.AddNewProfile
(
    L_ACKMAMODE =&gt; Packet.L_ACKMAMODE,
    Location =&gt; MessageTypes.QScaleDistance(Packet.D_MAMODE, Packet.Q_SCALE),
    L_MAMODE =&gt; Packet.L_MAMODE,
    M_MAMODE =&gt; Packet.M_MAMODE,
    V_MAMODE =&gt; Packet.V_MAMODE,
    Q_MAMODE =&gt; Packet.Q_MAMODE,
    Q_SCALE =&gt; Packet.Q_SCALE,
    GenericLSMarker =&gt; GenericLSMarker,
    aDistanceFromRef =&gt; aDistanceFromRef,
    infillModeProfile =&gt; infillModeProfile
)</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 Name="Add following profiles"
 Guid="76413865-dfc6-4396-8fe8-64ecedc67e8f"
>
<Comment>Adds the following elements of the mode profile.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Add following profiles"
 Guid="66b0b22b-84a7-4296-8a17-166e4bc4dfde"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="83b7183e-1ec2-4df8-9f80-f4aa411f0cbe"
>APPLY
    Kernel.MA.ModeProfile.AddNewProfile
    (
        L_ACKMAMODE =&gt; X.L_ACKMAMODE,
        Location =&gt; AbsoluteDistance(ModeProfiles =&gt; Packet.Sequence1, aModeProfile =&gt; X, Scale =&gt; Packet.Q_SCALE),
        L_MAMODE =&gt; X.L_MAMODE,
        M_MAMODE =&gt; X.M_MAMODE,
        V_MAMODE =&gt; X.V_MAMODE,
        Q_MAMODE =&gt; X.Q_MAMODE,
        Q_SCALE =&gt; Packet.Q_SCALE,
        GenericLSMarker =&gt; GenericLSMarker,
        aDistanceFromRef =&gt; aDistanceFromRef,
        infillModeProfile =&gt; infillModeProfile
    )
ON
    Packet.Sequence1</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="680"
 Y="20"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="AddNewProfile"
 Guid="ede52e42-b396-4eab-8d95-2a8c1281ddbd"
>
<ReqRef
 Id="4744429f-fce3-4833-817a-c0cd74ffcd7f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bd3f57f3-c2ad-4965-b084-583f7f16491c"
>
</ReqRef><ReqRef
 Id="e91cb267-376b-429f-8918-4d597fdcc562"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a802b86d-c666-456b-af88-308268eb6d5c"
>
</ReqRef><ReqRef
 Id="89925322-dec9-4aa4-8555-37decb3284a8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="453af72d-da1a-456e-a185-5b328f84fb81"
>
</ReqRef><ReqRef
 Id="d4f0c125-9a62-4674-b0f5-bcba928f4835"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="44be40d4-4fb4-40e3-b37d-770778857d8e"
>
</ReqRef><ReqRef
 Id="8f6cbd01-6f4a-4a45-9b12-053cfa6bbf95"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="13c6f75a-44a9-4dfc-8678-61399a667d10"
>
</ReqRef><ReqRef
 Id="64e2f87a-5cf2-41b5-880c-dd026169eb44"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5ad749c1-7096-47a6-a735-dee35aae0594"
>
</ReqRef><ReqRef
 Id="1eede305-f64b-4f63-a204-1c83dcb1ed2f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="07d6a2ec-a818-481d-a711-ae99c59a7730"
>
</ReqRef><ReqRef
 Id="b4a804d0-53f6-49e2-9897-24b3babe34bd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bbda7634-3ea3-4356-bda3-f2c326a5ffbc"
>
</ReqRef><ReqRef
 Id="456d49d8-e372-4a93-b53b-700d92362a8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f578d807-d771-4596-a961-1cce3a780c6e"
>
</ReqRef><ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6f943241-ac43-49de-ae82-c64115a28579"
>
</ReqRef><ReqRef
 Id="3b4bfa4e-f425-4b5d-a82e-aaaf923dad11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d83b6e2a-3f47-4435-a92c-e168712d1bf7"
>
</ReqRef><ReqRef
 Id="c57326e0-6fe8-4373-825f-149a86761548"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="674e9ce4-dece-4239-93f2-ce969812959b"
>
</ReqRef><Comment>Adds the new mode profile element received from the trackside.</Comment>
<Parameters>
<Parameter
 Type="MessageTypes.Length"
 Name="L_ACKMAMODE"
 Guid="8b987134-a0aa-4a09-90b1-fdd88cb4b5ee"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="Location"
 Guid="b1613141-f964-47a2-9297-e05209779fab"
>
</Parameter><Parameter
 Type="MessageTypes.Length"
 Name="L_MAMODE"
 Guid="4b4fd8b9-5a5b-440e-a5f6-6eae6ff0a57d"
>
</Parameter><Parameter
 Type="Messages.M_MAMODE"
 Name="M_MAMODE"
 Guid="c9f8ac70-6ee6-44d8-ae44-59a7c353b0c8"
>
</Parameter><Parameter
 Type="MessageTypes.Speed"
 Name="V_MAMODE"
 Guid="37ad71fc-21ba-44b2-a0e2-23a407780ba7"
>
</Parameter><Parameter
 Type="Messages.Q_MAMODE"
 Name="Q_MAMODE"
 Guid="94018a37-d9ad-477a-92f0-4f97c0e7a6dd"
>
</Parameter><Parameter
 Type="Messages.Q_SCALE"
 Name="Q_SCALE"
 Guid="59470058-475d-468a-b380-e1d74d140903"
>
</Parameter><Parameter
 Type="Boolean"
 Name="GenericLSMarker"
 Guid="c567c2c9-e49e-4c15-ace1-4d019f4ff251"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="aDistanceFromRef"
 Guid="1491706d-2a22-4aef-b53a-4c5a2a44e44f"
>
</Parameter><Parameter
 Type="Boolean"
 Name="infillModeProfile"
 Guid="c594098e-409d-4c94-ab99-b31b02d3f828"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Add new profile"
 Guid="aefe8386-f7a1-49e2-8a54-ed8dd6cef4fc"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Infill available, SH"
 Guid="9933d76e-d925-4c38-a175-ae2d2c268df1"
>
<ReqRef
 Id="bd3f7106-e2c1-465f-be7e-f47543c5f94b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ed72a11b-ae3f-4401-9f90-12dee8ae02ab"
>
</ReqRef><Comment>Inserts a new mode profile for Shunting mode, in case the mode profile was received by infill (=&gt; the distance is computed according to the infill value).</Comment>
<PreConditions>
<PreCondition
 Guid="022da320-6f5e-4431-a3a7-861e2096f6ac"
>infillModeProfile</PreCondition><PreCondition
 Guid="33384be8-0555-4b72-b9bc-a85b6064dffe"
>M_MAMODE == Messages.M_MAMODE.Shunting</PreCondition></PreConditions>
<Actions>
<Action
 Guid="9344dddf-f9b7-44bf-8229-ecb9b436017f"
>INSERT
    Kernel.MA.ModeProfile.ModeProfileStruct
    {
        AcknLength =&gt; MessageTypes.QScaleLength ( length =&gt; L_ACKMAMODE, scale =&gt; Q_SCALE ),
        Location =&gt; Location + BTM.Infill.DistanceToInfillReference(),
        Length =&gt; BaseTypes.Length.NA,
        Mode =&gt; ERTMS_To_EFS_Mode ( M_MAMODE ),
        Speed =&gt; MessageTypes.SpeedResolution ( speed =&gt; V_MAMODE, resolution =&gt; 5.0 ),
        SupervisionQualifier =&gt; Q_MAMODE
    }
IN
    Kernel.MA.ModeProfile.Profile</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="No infill available, SH"
 Guid="e17706c0-74ac-4c15-8627-8aec55d86a52"
>
<Comment>Inserts a new mode profile for Shunting mode, in case the mode profile was received without infill.</Comment>
<PreConditions>
<PreCondition
 Guid="7a8f0e52-383d-41ee-8df5-71a1521c2764"
>M_MAMODE == Messages.M_MAMODE.Shunting</PreCondition></PreConditions>
<Actions>
<Action
 Guid="68e9e673-7813-4947-b1d0-7efbeb20158e"
>INSERT
    Kernel.MA.ModeProfile.ModeProfileStruct
    {
        AcknLength =&gt; MessageTypes.QScaleLength ( length =&gt; L_ACKMAMODE, scale =&gt; Q_SCALE ),
        Location =&gt; aDistanceFromRef + Location,
        Length =&gt; BaseTypes.Length.NA,
        Mode =&gt; ERTMS_To_EFS_Mode ( M_MAMODE ),
        Speed =&gt; MessageTypes.SpeedResolution ( speed =&gt; V_MAMODE, resolution =&gt; 5.0 ),
        SupervisionQualifier =&gt; Q_MAMODE
    }
IN
    Kernel.MA.ModeProfile.Profile</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Infill available, LS or OS"
 Guid="aa57b292-68fc-4feb-b411-50f273bcfbf6"
>
<ReqRef
 Id="bd3f7106-e2c1-465f-be7e-f47543c5f94b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="eb3793a3-90a2-4df8-a3c2-69e0c13bc76b"
>
</ReqRef><Comment>Inserts a new mode profile for Limited Supervision of On-Sight modes, in case the mode profile was received by infill (=&gt; the distance is computed according to the infill value).</Comment>
<PreConditions>
<PreCondition
 Guid="f1684bcc-f007-401f-a563-b5b2c938adb4"
>infillModeProfile</PreCondition></PreConditions>
<Actions>
<Action
 Guid="fd905e47-15f3-4a3f-905a-8ef2acd85169"
>INSERT
    Kernel.MA.ModeProfile.ModeProfileStruct
    {
        AcknLength =&gt; MessageTypes.QScaleLength ( length =&gt; L_ACKMAMODE, scale =&gt; Q_SCALE ),
        Location =&gt; Location + BTM.Infill.DistanceToInfillReference(),
        Length =&gt; MessageTypes.QScaleLength ( length =&gt; L_MAMODE, scale =&gt; Q_SCALE ),
        Mode =&gt; ERTMS_To_EFS_Mode ( M_MAMODE ),
        Speed =&gt; GetSpeedResolution(V_MAMODE),
        SupervisionQualifier =&gt; Q_MAMODE
    }
IN
    Kernel.MA.ModeProfile.Profile</Action></Actions>
<SubRules>
<Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 Name="LS - No marker received"
 Guid="40e7e378-9c53-4324-814a-7d12e2560ca6"
>
<ReqRef
 Id="259b9778-4f75-4c5b-a658-9eef737938bf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="82229d0d-a9c5-4867-bf63-c6dca0946379"
>
</ReqRef><Comment>If no generic marker is received, the stored marker is removed.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="No marker"
 Guid="22f70c9c-3856-4b19-9418-24eef06f259b"
>
<PreConditions>
<PreCondition
 Guid="b2604372-b987-4a51-b556-c2757c4b3907"
>NOT GenericLSMarker</PreCondition></PreConditions>
<Actions>
<Action
 Guid="1f3d6bb1-d1d8-40d6-acf9-f4f4610ca528"
>Kernel.Modes.LimitedSupervision.GenericMarkerStored &lt;- False</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="No infill available, LS or OS"
 Guid="07db9b5d-c0c8-47e0-b272-7d8042bea88b"
>
<Comment>Inserts a new mode profile for Limited Supervision and On-Sight modes, in case the mode profile was received without infill.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="65882a47-d665-4ffa-8642-d5d84b9259ec"
>INSERT
    Kernel.MA.ModeProfile.ModeProfileStruct
    {
        AcknLength =&gt; MessageTypes.QScaleLength ( length =&gt; L_ACKMAMODE, scale =&gt; Q_SCALE ),
        Location =&gt; aDistanceFromRef + Location,
        Length =&gt; MessageTypes.QScaleLength ( length =&gt; L_MAMODE, scale =&gt; Q_SCALE ),
        Mode =&gt; ERTMS_To_EFS_Mode ( M_MAMODE ),
        Speed =&gt; GetSpeedResolution(V_MAMODE),
        SupervisionQualifier =&gt; Q_MAMODE
    }
IN
    Kernel.MA.ModeProfile.Profile</Action></Actions>
<SubRules>
<Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 Name="LS - No marker received"
 Guid="7e15adcd-7f7c-4123-86ba-b239dc562ac3"
>
<ReqRef
 Id="259b9778-4f75-4c5b-a658-9eef737938bf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c1f14513-9bed-4582-a613-f113e697f748"
>
</ReqRef><Comment>If no generic marker is received, the stored marker is removed.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="No marker"
 Guid="92c49840-ed53-45be-9a2a-c8d3a86c1d86"
>
<PreConditions>
<PreCondition
 Guid="56e14f59-2c1b-4c33-860c-221bd8bea952"
>NOT GenericLSMarker</PreCondition></PreConditions>
<Actions>
<Action
 Guid="62332412-16d4-4840-b334-6f4566fec990"
>Kernel.Modes.LimitedSupervision.GenericMarkerStored &lt;- False</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="680"
 Y="80"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="DeleteModeProfileBeyondLocation"
 Guid="eb6ef3c0-69da-430b-8e73-9be421757bd6"
>
<ReqRef
 Id="74a25803-8c28-4708-b506-55a76bd8bc21"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9912c05b-a2ff-4b0d-a17e-fb4d35f5215f"
>
</ReqRef><ReqRef
 Id="413303d1-7e96-41b7-a03e-3a9d6380e93a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="492c520d-3a50-4d8c-9311-5eaa02884428"
>
</ReqRef><ReqRef
 Id="2a495f6e-680c-4def-a6b5-d8bcd1f41a9d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c66f6f28-d0b1-483b-9b67-68045b48491b"
>
</ReqRef><Comment>Removes the mode profile elements situated beyond the given location.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="aLocation"
 Guid="4ba7841a-3c00-4427-99b9-5d572de530c9"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Remove mode profile beyond the given location"
 Guid="3fb32f5c-bb35-4b94-86f8-eac502c00085"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Remove mode profile beyond the given location"
 Guid="e2d9057b-6d4c-4f1c-a2fe-0eec006d8a77"
>
<ReqRef
 Id="2a495f6e-680c-4def-a6b5-d8bcd1f41a9d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6b4257a4-5f3d-45a7-a09b-71f728cf6fe2"
>
</ReqRef><Comment>If the MA is received by infill, the mode profile is deleted only beyond the reference location of the infill information.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="ca7c34df-e127-4393-a18b-a4fac6c5288e"
>Kernel.MA.ModeProfile.Profile &lt;- MAP Kernel.MA.ModeProfile.Profile | X.Location &lt; aLocation USING X IN Kernel.MA.ModeProfile.KeepTheProfileAccordingToLocation
(
  aProfile =&gt; X,
  aLocation =&gt; aLocation
)</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="40"
 Y="400"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="ClearProfile"
 Guid="cc09f98d-b844-43b3-acce-4956ab9c92ce"
>
<ReqRef
 Id="03b6c53e-3c15-4db3-8d90-3353c60fd14d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="170c454f-b40a-4783-8209-d01d1eb6fff1"
>
</ReqRef><ReqRef
 Id="eaa70a17-109a-45b5-8747-ecc49e581ccd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e950a3ab-3286-40af-8a21-512f66444e47"
>
</ReqRef><Comment>The the train exits an element of the mode profile, it has to be removed together with its acknowledgement.</Comment>
<Rules>
<Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 Name="Hide acknowledgements of the elements that will be removed"
 Guid="35c577e8-2979-4dfd-a336-91a13af0047c"
>
<ReqRef
 Id="3e329bf5-959c-4332-a482-b1816ce364d2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="378c6fbc-302f-4f7a-867a-2ff3f3a6baab"
>
</ReqRef><ReqRef
 Id="69d11b6a-6ae6-4d77-8ddf-bdb543c96261"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="acc721cb-1024-4ffa-ad02-efc2f57e3b17"
>
</ReqRef><Comment>If some elements of the mode profile have to be deleted, their corressponding acknowledgements have to be removed.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Hide acknowledgements of the elements that will be removed"
 Guid="8e006fca-73eb-41cd-abb7-8a3c1b57f88f"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="ed341883-9f2e-48c5-a823-86222c1ba68c"
>APPLY
  Kernel.MA.ModeProfile.RemoveAcknowledgement ( aModeProfile =&gt; X )
ON
  Kernel.MA.ModeProfile.Profile | Kernel.MA.ModeProfile.RemoveModeProfile ( aProfile =&gt; X )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 X="0"
 Y="0"
 Implemented="TRUE"
 Name="Remove the elements"
 Guid="d893ed86-8908-430e-9ce9-b2f6b33eda50"
>
<Comment>Finally, the elements to remove are removed.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Remove the elements"
 Guid="199cbcbd-1308-4cfd-8112-42b6b3e4205c"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="44cd0c9c-d1f7-40d7-bb32-20482a318560"
>REMOVE ALL RemoveModeProfile ( X ) IN  Profile</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="441"
 Y="1"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="RemoveAcknowledgement"
 Guid="df85c746-8af8-43bd-a038-bf4c64fe1ae9"
>
<ReqRef
 Id="3e329bf5-959c-4332-a482-b1816ce364d2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a65583a5-07a7-42c9-99de-15e798b15778"
>
</ReqRef><ReqRef
 Id="69d11b6a-6ae6-4d77-8ddf-bdb543c96261"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a3b00ac8-e813-428f-b854-86b48f8d0843"
>
</ReqRef><Comment>Removes the acknowledgement corresponding to the provided mode profile element.</Comment>
<Parameters>
<Parameter
 Type="ModeProfileStruct"
 Name="aModeProfile"
 Guid="e7f530a9-825e-4e5f-92cc-817ccfe99cd5"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Remove acknowledgement"
 Guid="ff965ebe-7d0d-4c5b-bc66-59bc906ef578"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="LS"
 Guid="40b6e8dd-2884-4eef-aa11-906c23d30b25"
>
<Comment>The mode of the provided element is LS.</Comment>
<PreConditions>
<PreCondition
 Guid="d88d578c-dc2f-4ca1-92e3-d11984d75759"
>aModeProfile.Mode == ModeEnum.ModeProfile.LS</PreCondition></PreConditions>
<Actions>
<Action
 Guid="caa07fc0-3bca-454c-98a6-6f17370c36eb"
>DMI.IN.Acknowledgements.RemoveAcknowledgement( aAcknowledgementType =&gt; DMI.IN.Acknowledgements.AckTypeEnum.LSMode )</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="OS"
 Guid="cf898b61-252c-49e5-880b-56759166c9d8"
>
<Comment>The mode of the provided element is OS.</Comment>
<PreConditions>
<PreCondition
 Guid="10d5da94-934f-47b5-aa89-1883d27c3012"
>aModeProfile.Mode == ModeEnum.ModeProfile.OS</PreCondition></PreConditions>
<Actions>
<Action
 Guid="c1f907d9-ce75-4e97-ae03-66b08d5e69b6"
>DMI.IN.Acknowledgements.RemoveAcknowledgement( aAcknowledgementType =&gt; DMI.IN.Acknowledgements.AckTypeEnum.OSMode )</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="SH"
 Guid="ce0bb749-6bf9-431d-9e34-a5942225d82b"
>
<Comment>The mode of the provided element is SH.</Comment>
<PreConditions>
<PreCondition
 Guid="d6214b7c-5a3e-41da-900e-01479f36f5b6"
>aModeProfile.Mode == ModeEnum.ModeProfile.SH</PreCondition></PreConditions>
<Actions>
<Action
 Guid="93777c21-79d2-410e-9493-701ab3060a21"
>DMI.IN.Acknowledgements.RemoveAcknowledgement( aAcknowledgementType =&gt; DMI.IN.Acknowledgements.AckTypeEnum.SHMode )</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<Variables>
<Variable
 Type="ModeProfileCol"
 DefaultValue="[]"
 VariableMode="Internal"
 X="50"
 Y="310"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="Profile"
 Guid="1a6aab28-6509-409b-9625-b33e588a826f"
>
<ReqRef
 Id="cbef1165-fc33-4ac1-994e-5f8a83f5e225"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3118a0d9-44fb-427b-90b7-e2542c207fd8"
>
</ReqRef><ReqRef
 Id="d7eddae1-a7bf-4be3-8180-19f2e70ac2fd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="319fb5a2-777c-4f37-9ee3-65a7f3ecb413"
>
</ReqRef><ReqRef
 Id="4650224e-986e-4212-b1a4-704ebe9317a4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="898c194b-8c74-4102-81ff-8da263265d27"
>
</ReqRef><ReqRef
 Id="4a580e9d-fd64-4951-b7a4-51530d1469e7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f26155a6-853b-4653-80a9-c52880cbafe9"
>
</ReqRef><ReqRef
 Id="98b78c68-b649-45c4-9dd8-6bfbf4a8f9c1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="89c231c0-cc82-4a47-9f1f-c44317f85ca2"
>
</ReqRef><ReqRef
 Id="456d49d8-e372-4a93-b53b-700d92362a8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3134f1b5-d143-41c3-8b99-8be18a9f2af1"
>
</ReqRef><ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="31aec4c3-9e11-41e6-b773-8d8199ee5c8b"
>
</ReqRef><ReqRef
 Id="3b4bfa4e-f425-4b5d-a82e-aaaf923dad11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9dbbea2e-ba67-4178-b43a-980d124aae73"
>
</ReqRef><ReqRef
 Id="c57326e0-6fe8-4373-825f-149a86761548"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4bbede8a-066e-489f-8d76-904dd5b22336"
>
</ReqRef><ReqRef
 Id="78901f0f-a70f-415d-8d57-e5156f7206d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="87365cec-3018-4bc2-beaf-132991b7155d"
>
</ReqRef><Comment>Represents the mode profile of the train.</Comment>
</Variable></Variables>
<Rules>
<Rule
 Priority="CleanUp"
 X="570"
 Y="200"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 Name="Clear profile"
 Guid="861c2421-ea67-4299-abec-0d8d26269696"
>
<ReqRef
 Id="eaa70a17-109a-45b5-8747-ecc49e581ccd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d3558914-a7c8-432c-9be2-caf005deb80d"
>
</ReqRef><ReqRef
 Id="03b6c53e-3c15-4db3-8d90-3353c60fd14d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1c347756-616b-4ccf-a015-61883bd90610"
>
</ReqRef><ReqRef
 Id="a0239fb6-709c-4818-9907-463b7c24e661"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a9d9c6bc-a9c3-4c7c-a1c3-6b44068e73df"
>
</ReqRef><Comment>Removes the mode profile elemets that are not applicable anymore.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Clear profile"
 Guid="34b2d5de-80a8-4539-96e6-c35627980e9b"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="bef1dd94-9db8-4d2d-86e9-aa0a15bb0913"
>Kernel.MA.ModeProfile.ClearProfile()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 X="680"
 Y="200"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Display driver ack"
 Guid="413fa19c-51c6-4d80-8f2b-56d878b3285f"
>
<ReqRef
 Id="34700a82-fd46-452e-82c7-77f81db8c569"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5637c905-6d83-46c3-916d-5c53ec9b4e48"
>
</ReqRef><Comment>For the modes SB and PT, the acknowledgement procedure is launched in the procedures Start of Mission and Train Trip respectively.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Display driver ack for OS"
 Guid="917932cd-dbe2-40a0-8e32-73a0be2b54e2"
>
<ReqRef
 Id="4ebd4845-9d08-4721-8788-6991ab66d3eb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5a4a83cb-59d0-4e88-946e-3d52bb7b9b75"
>
</ReqRef><ReqRef
 Id="33b54e77-9cb2-4190-92cd-1cfeb3a94b5d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d4924f19-9eab-48c8-b282-579132050e78"
>
</ReqRef><ReqRef
 Id="83b4c9f4-e480-4a7c-96f4-1e05dbd4b32f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6baae0da-52a4-4b76-bcd3-149e426fa6c2"
>
</ReqRef><ReqRef
 Id="f8b146ed-492a-43af-b78d-fbd3e12aa731"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="af636e4f-758d-4bd1-a1d4-6b1ee23b8d6c"
>
</ReqRef><ReqRef
 Id="02990d41-6bf4-4c89-94b5-aee9d1db2510"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6cb9f5e3-6f0f-449a-b776-da8e307fd840"
>
</ReqRef><ReqRef
 Id="becf543b-94ee-4436-85b2-708e4e58eb59"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="acd1e175-c0cd-4942-b746-d47da15000b0"
>
</ReqRef><ReqRef
 Id="9a63ec40-59c4-454f-a41d-51030fc51481"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7805c3ce-592e-496e-bbcb-2e43dc7743da"
>
</ReqRef><ReqRef
 Id="6e265aec-2ccf-45a4-8713-34d7ea277c53"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2cfaa422-d2fe-404b-b28c-cf93722a90ff"
>
</ReqRef><Comment>Requests the acknowledgement from the driver for OS mode.</Comment>
<PreConditions>
<PreCondition
 Guid="6d1c7801-3e7d-452d-9a52-40bebe0ec5fd"
>Kernel.Mode not in [ModeEnum.OS, ModeEnum.SB, ModeEnum.PT]</PreCondition><PreCondition
 Guid="42784a5a-1cae-4c0b-811f-443315954aca"
>THERE_IS X IN Kernel.MA.ModeProfile.Profile | X.Mode == ModeEnum.ModeProfile.OS
  AND
Kernel.MA.ModeProfile.AcknAreaReached ( FIRST X IN Kernel.MA.ModeProfile.Profile | X.Mode == ModeEnum.ModeProfile.OS )</PreCondition><PreCondition
 Guid="66b2c6ba-7c31-4c87-9718-93a1cb7db83d"
>Kernel.Modes.ModeRelatedSpeedLimits.OSModeSpeedLimit() &gt; Odometry.TrainSpeed()</PreCondition><PreCondition
 Guid="9c07352e-7368-4267-b097-8f8ae8201d4d"
>NOT (DMI.MasterDMI().In_AcknOfOSMode.InputInformation.RequestStatus == RequestEnum.Request)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="82ba23e0-1820-477a-9003-f622746b0571"
>DMI.MasterDMI().In_AcknOfOSMode.InitiateRequest()</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Display driver ack for LS"
 Guid="3e827100-8525-4e86-9c20-97c273e0d79a"
>
<ReqRef
 Id="4fb449e7-3376-4d1d-9cb1-7ab1bbb762c0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="12925cd9-b799-45c8-8456-aa188709d491"
>
</ReqRef><ReqRef
 Id="2ae92ee4-8298-478f-94c4-806e389cc5cb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ca9b2aca-f2f7-448f-9945-a70b04d8871c"
>
</ReqRef><ReqRef
 Id="f0920be8-e671-4e0b-bc0b-5be12d23b1e3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3db52e8b-d658-4024-97fc-f4d8accc538e"
>
</ReqRef><ReqRef
 Id="7eb769c6-7a5f-4b65-8ae8-09c3c01deb44"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ade9f611-2d7b-4c98-8cce-85c4c4c60454"
>
</ReqRef><ReqRef
 Id="af9486e0-4055-4c87-949a-b752d1b54a50"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="73be83c7-7c26-411b-b16c-4815e81880fd"
>
</ReqRef><ReqRef
 Id="504f5bac-204f-4aec-a4b3-3b1b00862286"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1841f833-a383-44f0-bfd3-18b4d4664991"
>
</ReqRef><ReqRef
 Id="7cba24fb-f8f0-411d-b295-e943d3f930c1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bf63d74a-dead-415b-bc99-8608d368a2ac"
>
</ReqRef><ReqRef
 Id="8c7eb4ff-2716-4d9f-a6f2-bd52aacc416b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="41c7688c-1f16-4acf-910f-6eb4d335c50b"
>
</ReqRef><Comment>Requests the acknowledgement from the driver for LS mode.</Comment>
<PreConditions>
<PreCondition
 Guid="5600aaf9-7d5c-4a4b-b01c-dcbf24977c52"
>Kernel.Mode not in [ModeEnum.LS, ModeEnum.SB, ModeEnum.PT]</PreCondition><PreCondition
 Guid="eb47dd1f-303f-4d40-9087-cb226e89eea5"
>THERE_IS X IN Kernel.MA.ModeProfile.Profile | X.Mode == ModeEnum.ModeProfile.LS
 AND
Kernel.MA.ModeProfile.AcknAreaReached ( FIRST X IN Kernel.MA.ModeProfile.Profile | X.Mode == ModeEnum.ModeProfile.LS )</PreCondition><PreCondition
 Guid="961a9514-325f-4dd3-8288-f7f5c316bf3b"
>Kernel.Modes.ModeRelatedSpeedLimits.LSModeSpeedLimit() &gt; Odometry.TrainSpeed()</PreCondition><PreCondition
 Guid="3da0d65b-0e2b-4020-8afd-97fbbee5539f"
>NOT (DMI.MasterDMI().In_AcknOfLSMode.InputInformation.RequestStatus  == RequestEnum.Request)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="b5e35da4-c967-4a59-85c6-a08ce49af47a"
>DMI.MasterDMI().In_AcknOfLSMode.InitiateRequest()</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Display driver ack for SH"
 Guid="7a67803e-50d7-4bb2-a902-fc9d924e1df0"
>
<ReqRef
 Id="ff0a5aad-f1c0-4297-8d8f-e10acf97e4cb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="92da6ab8-2171-4fc5-a412-0ca5b4fd785c"
>
</ReqRef><ReqRef
 Id="9cce28e1-bf30-4268-94b6-ed70b2b1533e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ef8a3701-2324-469a-88b0-f1a6777a8858"
>
</ReqRef><ReqRef
 Id="69196e9c-9533-43f3-8c1f-cd9a9b248178"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c9742a59-046a-4b41-87d7-3d30d5e8d1d2"
>
</ReqRef><ReqRef
 Id="dc4be9b4-1646-45e4-bf8b-64af5d107a36"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="70b3bfec-4ab5-4f83-98f3-ef01298922e5"
>
</ReqRef><ReqRef
 Id="39ae88ad-20ca-43d1-8c3f-5f7172777b6e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="35e408c0-1d04-4f6a-80e6-056c81f9ce1b"
>
</ReqRef><Comment>Requests the acknowledgement from the driver for SH mode.</Comment>
<PreConditions>
<PreCondition
 Guid="a6b8a37e-3e25-40ae-ba2c-da28116ece59"
>Kernel.Mode not in [ModeEnum.SB, ModeEnum.PT]</PreCondition><PreCondition
 Guid="55cf8108-eb50-4bee-ad58-f34d699f55d3"
>THERE_IS X IN Kernel.MA.ModeProfile.Profile | X.Mode == ModeEnum.ModeProfile.SH
  AND
Kernel.MA.ModeProfile.AcknAreaReached ( FIRST X IN Kernel.MA.ModeProfile.Profile | X.Mode == ModeEnum.ModeProfile.SH )</PreCondition><PreCondition
 Guid="b7041bbe-293e-4a65-9f11-1f7ea8cd24b3"
>Kernel.Modes.ModeRelatedSpeedLimits.SHModeSpeedLimit() &gt; Odometry.TrainSpeed()</PreCondition><PreCondition
 Guid="778ffeec-9d0d-4cc8-9cdb-a9b312b12afe"
>NOT (DMI.MasterDMI().In_AcknOfSHMode.InputInformation.RequestStatus == RequestEnum.Request)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="c13e2743-8c40-487f-84d9-9f5b18f67495"
>DMI.MasterDMI().In_AcknOfSHMode.InitiateRequest()</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</NameSpace>
