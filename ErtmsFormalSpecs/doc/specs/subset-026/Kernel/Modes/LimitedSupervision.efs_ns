<NameSpace
 X="20"
 Y="10"
 Width="100"
 Height="50"
 Name="LimitedSupervision"
 Guid="cdb147cf-96f4-4e75-af93-fcc12553245f"
>
<NameSpaces>
</NameSpaces>
<Functions>
<Function
 Type="BaseTypes.Speed"
 Default=""
 X="20"
 Y="160"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSSMA"
 Guid="928abe4d-839f-461f-9e89-b7dfa7b45cf3"
>
<ReqRef
 Id="e3caa999-1864-4f55-998d-66166d0a163b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6a4dc568-aa7d-4f07-ad2a-4d469d80cd3d"
>
</ReqRef><ReqRef
 Id="7ff97a9b-f10c-4e4c-b174-b68c9f680b6e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2b5df077-f19a-4e3a-b038-3865bdfe5214"
>
</ReqRef><ReqRef
 Id="37c50c6b-4e41-4db0-ad87-b7b3d074bc00"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fb8eb045-43a8-4078-bda0-11b06e7dd894"
>
</ReqRef><Comment>Provides the Lowest Supervised Speed within the Movement Authority for display on the DMI.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="a795b238-b08a-466f-9212-549c49ace202"
>
<Expression>REDUCE Kernel.SpeedAndDistanceMonitoring.TargetsList() | X.Location &lt;= MA.EOA().Location
 USING X IN BaseTypes.MinSpeed(
    X1 =&gt; X.Speed,
    X2 =&gt; RESULT
    )
 INITIAL_VALUE BaseTypes.Speed.MaxSpeed</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="350"
 Y="160"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSMarkerPresent"
 Guid="80f48457-e268-4406-8dbe-b87ad27f3412"
>
<ReqRef
 Id="259b9778-4f75-4c5b-a658-9eef737938bf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0358f21f-5b75-4090-b12a-6cb748d12333"
>
</ReqRef><ReqRef
 Id="2922527c-9e20-48f5-a094-94014ef0aa69"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fe691462-b0cf-46cf-8c12-1f6a559d3caa"
>
</ReqRef><ReqRef
 Id="e9f9dfc1-5e6c-4920-958e-20889458cdd1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ea8a6944-4ffb-40e2-a5d1-e7a2cba8b98b"
>
</ReqRef><Comment>Checks the Balise message for an applicable Generic LS Function Marker packet.</Comment>
<Parameters>
<Parameter
 Type="BTM.BaliseGroupMessagesCol"
 Name="Messages"
 Guid="e2df65a0-1bff-41c8-88b3-77a0ec29cf8f"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="138c3e29-2865-4d85-9949-628b35db01f7"
>
<Expression>THERE_IS Message IN Messages | 
(
  THERE_IS Packet IN Message.Telegram.Sequence1 |
    BTM.Packets.ConsiderBTMPacket(
        PacketOrientation =&gt; Packet.TRACK_TO_TRAIN.GENERIC_LS_FUNCTION_MARKER.Q_DIR,
        MessageOrientation =&gt; BTM.BGOrientation( Messages )
    )
)</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="221"
 Y="241"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="DisplayLSSMA"
 Guid="b34403e8-eb3a-4b58-8bb1-744e0959d768"
>
<ReqRef
 Id="e3caa999-1864-4f55-998d-66166d0a163b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="06f7806c-a48f-4b36-8c56-ce3744e3d7d4"
>
</ReqRef><ReqRef
 Id="569567b3-3681-4d80-9bed-9a1376f4cd6f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1e63165b-c717-4e6a-86eb-74373bf7a2ac"
>
</ReqRef><ReqRef
 Id="cc5dadda-f34e-4f97-a9b7-e5e5b8f9e82f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8273f02b-f074-4e52-94dd-06ef8bda9577"
>
</ReqRef><ReqRef
 Id="b54058d6-eecd-40ca-883f-f77c6bf457b1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b7afbc8c-d0dd-4e6a-bdfe-7d81f366f837"
>
</ReqRef><ReqRef
 Id="2b70094d-4b34-482b-8e02-5076957231fb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="804fa796-5774-4d17-a76a-fad7b20e357b"
>
</ReqRef><ReqRef
 Id="2378ec5b-b103-4415-b159-4c016a0c0966"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7cddbf2e-422b-43c8-96b6-b88b0dff77b5"
>
</ReqRef><Comment>Indicates whether the DMI should display the LSSMA.</Comment>
<Cases>
<Case
 Name="Not in LS mode"
 Guid="a0c70c66-7136-49d6-a8eb-45a240957935"
>
<PreConditions>
<PreCondition
 Guid="ce15574c-9544-463f-835e-9766152d39a3"
>Mode != ModeEnum.LS</PreCondition></PreConditions>
<Expression>False</Expression>
</Case><Case
 Name="No generic LS function marker"
 Guid="7c8a6535-249e-458a-837b-f64de33866ad"
>
<PreConditions>
<PreCondition
 Guid="c796539d-664f-4918-a0c8-b0c2e53034a8"
>NOT GenericMarkerStored</PreCondition></PreConditions>
<Expression>Kernel.MA.MA.TargetSpeed &lt; Kernel.Modes.ModeRelatedSpeedLimits.LSModeSpeedLimit()
  AND  
Kernel.Modes.LimitedSupervision.LSSMA() &lt; TrainData.TrainData.Value.MaximumSpeed</Expression>
</Case><Case
 Name="Generic LS function marker stored on-board"
 Guid="4f9df80d-9a00-4467-8723-180d992ddfe0"
>
<Expression>LSSMADisplayOrder in [Messages.Q_LSSMA.Toggle_on]
  AND  
DateAndTime.TimeOutPassed(LSSMADisplayTimeOut)</Expression>
</Case></Cases>
</Function></Functions>
<Procedures>
<Procedure
 X="20"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSSMAToggleReceived"
 Guid="22c1b21a-75b1-4006-8452-ba171f6ab645"
>
<ReqRef
 Id="569567b3-3681-4d80-9bed-9a1376f4cd6f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e4704ab4-9bff-4b47-b832-3cdc8d8c25f1"
>
</ReqRef><ReqRef
 Id="5ab8592b-d34d-449a-b9b4-a49404c758ed"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="74832289-a479-4ea9-83db-6848482a1203"
>
</ReqRef><ReqRef
 Id="fa830e21-7694-4e0e-b5e1-ec5a23036c07"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="45d00f7a-de3e-406d-8d6d-fac30020c753"
>
</ReqRef><ReqRef
 Id="18659e26-db48-44a9-99f6-e2b9335a9581"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="35107d02-9267-4c90-a4ff-c1660bfc1478"
>
</ReqRef><ReqRef
 Id="cc5dadda-f34e-4f97-a9b7-e5e5b8f9e82f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2fc9da03-c005-451f-9179-7cedce159527"
>
</ReqRef><ReqRef
 Id="7a1c72d6-e564-40a5-ac23-c5e4926af96f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e96835fd-f4ce-4763-bc05-6848f60393de"
>
</ReqRef><ReqRef
 Id="cb1268f7-53cb-49c8-a6d9-4e4b32f7774f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3152d1d5-006f-4683-abbd-708a98c9d10f"
>
</ReqRef><Comment>Handles the reception of a LSSMA TOGGLE ORDER packet received from trackside.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.LSSMA_DISPLAY_TOGGLE_ORDER.Message"
 Name="Packet"
 Guid="87e8069d-2228-45f8-9cdf-3ac6399ec97b"
>
</Parameter><Parameter
 Type="DateAndTimeStruct"
 Name="Timestamp"
 Guid="c4071851-c23c-4987-8f79-87eab60bcbf5"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle packet"
 Guid="df0ee044-583d-4d3d-9cd1-75bf08985ee9"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Store toggle order"
 Guid="34d018bc-1420-4995-b12f-a9518c2ac1bc"
>
<ReqRef
 Id="8875844d-6767-46d6-81e6-f515e52f4417"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fe28c2bd-641a-469f-a823-498818601b56"
>
</ReqRef><Comment>Received order to toggle LSSMA display off.</Comment>
<PreConditions>
<PreCondition
 Guid="9f5c5229-f103-4bc9-8913-b0de22327985"
>Packet.Q_LSSMA == Messages.Q_LSSMA.Toggle_off</PreCondition></PreConditions>
<Actions>
<Action
 Guid="bbd8de6f-c017-4c43-8813-479a83feb5ca"
>LSSMADisplayOrder &lt;- Packet.Q_LSSMA</Action><Action
 Guid="e6cbc16f-e753-4b29-b052-f2401dfd0902"
>LSSMADisplayTimeOut &lt;- AddToDate(
    StartDate=&gt;Timestamp,
    Increment=&gt;MessageTypes.TimeResolution(Packet.T_LSSMA)
)</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<Variables>
<Variable
 Type="Messages.Q_LSSMA"
 DefaultValue="Messages.Q_LSSMA.Toggle_off"
 VariableMode="Internal"
 X="160"
 Y="20"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSSMADisplayOrder"
 Guid="e288e932-4856-4e56-8601-01a602e8dc33"
>
<ReqRef
 Id="e3caa999-1864-4f55-998d-66166d0a163b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3037d040-75ae-4329-b2e8-5af66abc1a94"
>
</ReqRef><ReqRef
 Id="7a1c72d6-e564-40a5-ac23-c5e4926af96f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d6ed695f-e6cb-4a14-b2e8-6a3d95b7172c"
>
</ReqRef><ReqRef
 Id="a2ec7ec3-6644-47d6-8ee1-9e4b16650cc3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="88263247-c23d-434d-bbb4-ed8dc5394746"
>
</ReqRef><ReqRef
 Id="a6eade55-4b84-45f2-a021-fd589f3d1760"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0d9ed8ef-6f50-4c54-98c7-add6342de301"
>
</ReqRef><ReqRef
 Id="6eeca2b4-7feb-46e5-9918-59197fd2bd89"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b3ec7f15-8f0a-4747-9def-ec835e7e1c71"
>
</ReqRef><Comment>Indicates whether the display of the LSSMA has been requested by trackside.</Comment>
</Variable><Variable
 Type="DateAndTimeStruct"
 DefaultValue="DateAndTimeStruct{}"
 VariableMode="Internal"
 X="380"
 Y="20"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSSMADisplayTimeOut"
 Guid="2106ccd6-7457-45ef-8768-a84abd3e73db"
>
<ReqRef
 Id="569567b3-3681-4d80-9bed-9a1376f4cd6f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="023085e6-f53f-43f6-bde1-910ae6d45a77"
>
</ReqRef><ReqRef
 Id="cc5dadda-f34e-4f97-a9b7-e5e5b8f9e82f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6a25512c-51fb-4d04-9344-f4cdd1069b7f"
>
</ReqRef></Variable><Variable
 Type="Boolean"
 DefaultValue="False"
 VariableMode="Internal"
 X="270"
 Y="20"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="GenericMarkerStored"
 Guid="69ca29b8-9d78-4906-abb2-1854361786c0"
>
<ReqRef
 Id="b54058d6-eecd-40ca-883f-f77c6bf457b1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="168780a7-2304-45e5-88e6-6efebb5d6ef4"
>
</ReqRef><Comment>Indicates whether the generic LS function marker is stored on-board.</Comment>
</Variable></Variables>
</NameSpace>
